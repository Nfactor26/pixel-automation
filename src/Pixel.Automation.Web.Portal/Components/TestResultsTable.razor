
<MudTable ServerData="@(new Func<TableState, Task<TableData<TestResultViewModel>>>(GetTestResultsAsync))"
          Dense="false" Hover="true" ReadOnly="true" SortLabel="Sort By" Elevation="4" @ref="table">
    <ToolBarContent>
        <MudText Typo="Typo.h6">@TableHeader</MudText>
        @*<MudToolBarSpacer />
        <MudTextField Placeholder="Search" Adornment="Adornment.Start" @bind-Value="@searchString"
                      AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>*@
    </ToolBarContent>
    <HeaderContent>
        <MudTh></MudTh>
        @if (ShowExecutionOrder)
        {
            <MudTh>#</MudTh>
        }
        @if (ShowExecutionDate)
        {
            <MudTh>Executed On</MudTh>
        }
        <MudTh>Fixture Name</MudTh>
        <MudTh>Test Name</MudTh>
        <MudTh>Execution Time</MudTh>
        <MudTh>Result</MudTh>
        <MudTh>Statistics</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd>
            <MudToggleIconButton ToggledChanged="@(() => OnToggleErrorDetailsPanelVisibility(context.Id))"
                                 Icon="@Icons.Material.Filled.ExpandMore" Color="@Color.Error" Disabled="@(context.ErrorDetails == null)"
                                 ToggledIcon="@Icons.Material.Filled.ExpandLess" ToggledColor="@Color.Error" />
        </MudTd>
        @if (ShowExecutionOrder)
        {
            <MudTd DataLabel="#">
                @context.ExecutionOrder
            </MudTd>
        }

        @if (ShowExecutionDate)
        {
            <MudTd DataLabel="#">
                @context.ExecutedOn
            </MudTd>
        }
        <MudTd DataLabel="Fixture Name">
            @context.FixtureName
        </MudTd>
        <MudTd DataLabel="Test Name">
            @context.TestName
        </MudTd>
        <MudTd DataLabel="Execution Time">@String.Format("{0:0.000#}", context.ExecutionTime) m</MudTd>
        <MudTd DataLabel="Status">
            <ResultIcon Result="@context.Result" />
        </MudTd>
        <MudTd DataLabel="Statistics">
            <MudButton Link="@($"test-statistics/{context.TestId}")" Variant="Variant.Filled">
                View Stats
            </MudButton>
        </MudTd>
    </RowTemplate>
    <ChildRowContent>
        @if (context.IsErrorDetailsVisible)
        {
            <ErrorDetails IsFailureReasonEditable="true" FailureDetails="@context.ErrorDetails" />
        }
    </ChildRowContent>
    <PagerContent>
        <MudTablePager PageSizeOptions="pageSizeOptions" RowsPerPageString="Results Per Page" />
    </PagerContent>
    <ColGroup>
        <col style="width:20px;" />
        @if (ShowExecutionOrder)
        {
            <col />
        }
        @if (ShowExecutionDate)
        {
            <col />
        }
        <col />
        <col />
        <col />
        <col />
    </ColGroup>
</MudTable>
